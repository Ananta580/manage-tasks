<ng-container *ngIf="user$ | async as user">
  <div class="fixed top-0 w-full z-10 bg-gradient-to-r from-black via-zinc-900 to-black text-gray-50 shadow-sm">
    <div class="flex justify-between items-center px-8 py-3">
      <div class="flex items-center gap-5">
        <img class="h-6" src="../../../../../assets/images/logo.svg" />
        <p class="text-lg">
          {{ currentDate$ | async | date : "hh:mm a" }}
        </p>
        <!-- "Good morning" Message -->
        <div class=" flex gap-2 ml-3">
          <span class="font-light">{{ greeting }} </span>
          <span class="font-normal">
            {{user?.name}}
          </span>
        </div>
      </div>

      <!-- User Actions -->
      <div class="flex items-center gap-2">
        <input id="search" placeholder="Search" (input)="searchTask($event)"
          class="p-2 px-5 mr-5 bg-white text-gray-500 border border-gray-300 rounded-full outline-none focus:ring-1 focus:ring-black" />
        <!-- Add Task Button -->
        <button routerLink="/app/task"
          class="h-10 w-10 flex justify-center items-center bg-white bg-opacity-25 hover:bg-opacity-80 hover:text-black rounded-full text-white transition-all">
          <mat-icon>add</mat-icon>
        </button>

        <!-- Themes Button -->
        <!-- <button (click)="changeTheme()"
          class="h-10 w-10 flex justify-center items-center bg-transparent hover:bg-[#ffffff44] rounded-full ">
          <mat-icon>{{ theme == "dark" ? "wb_sunny" : "wb_sunny" }}</mat-icon>
        </button> -->

        <!-- Settings Button -->
        <button cdkOverlayOrigin #trigger="cdkOverlayOrigin" (click)="showSettingPopup = !showSettingPopup"
          class="h-10 w-10 flex justify-center items-center bg-transparent hover:bg-[#ffffff44] rounded-full ">
          <mat-icon>settings</mat-icon>
        </button>

        <!-- User Avatar Button -->
        <button routerLink="/app/setting"
          class="h-10 w-10 flex justify-center items-center bg-transparent border-2 bg-black bg-opacity-25 rounded-full text-white">
          <span>
            {{ getUserInitials(user.name) }}
          </span>
        </button>
      </div>
    </div>

    <!-- Setting Popup -->
    <ng-template cdkConnectedOverlay cdkConnectedOverlayBackdropClass="cdk-overlay-transparent-backdrop"
      [cdkConnectedOverlayHasBackdrop]="true" [cdkConnectedOverlayOrigin]="trigger"
      [cdkConnectedOverlayOpen]="showSettingPopup" (backdropClick)="showSettingPopup = false">
      <ul class="bg-white m-2 shadow-md rounded-md min-w-[190px] overflow-hidden">
        <li class="p-4 text-red-800 flex gap-3 cursor-pointer hover:bg-gray-50 " (click)="showClearDataPopup()">
          <mat-icon class="text-lg">clear</mat-icon>Clear my data
        </li>
        <li class="p-4 border-t flex gap-3 cursor-pointer hover:bg-gray-50 " (click)="updateProfile()">
          <mat-icon class="text-lg">account_circle</mat-icon>Update Profile
        </li>
        <li class="p-4 border-t text-emerald-800 flex gap-3 cursor-pointer hover:bg-gray-50 ">
          <mat-icon class="text-lg">public</mat-icon>Switch online
        </li>
      </ul>
    </ng-template>
  </div>
</ng-container>

<!-- Popup for Confirmation -->
<app-modal *ngIf="showModal">
  <div class="p-5 bg-white  rounded-md flex flex-col gap-5">
    <!-- Modal Title -->
    <h1 class="font-semibold flex justify-between items-center ">
      Confirm Data Deletion
      <span class="material-symbols-outlined cursor-pointer" (click)="this.showModal = false">
        close
      </span>
    </h1>
    <!-- Body Section -->
    <p>
      Are you sure you want to clear the data? This action is irreversible and
      will permanently delete all selected data from application.
    </p>
    <!-- Footer Section -->
    <section>
      <button (click)="clearMyData()" class="px-10 py-3 bg-red-700 text-white text-sm rounded-md hover:bg-red-800">
        Confirm
      </button>
    </section>
  </div>
</app-modal>